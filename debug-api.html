<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Debug API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>Debug API –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h1>
    <button onclick="testAPI()">–¢–µ—Å—Ç—É–≤–∞—Ç–∏ API</button>
    <div id="log" class="log"></div>

    <script>
        function addLog(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
            logDiv.innerHTML += `<span style="color: #666;">[${timestamp}]</span> <span class="${className}">${message}</span>\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        async function testAPI() {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML = '';
            
            addLog('üîÑ –¢–µ—Å—Ç—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ API...');
            
            try {
                const response = await fetch('https://merch-count1.netlify.app/.netlify/functions/inventory');
                addLog(`HTTP Status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    addLog(`–î–∂–µ—Ä–µ–ª–æ: ${data.source || 'unknown'}`, 'success');
                    addLog(`–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—ñ–≤: ${data.inventory ? data.inventory.length : 0}`, 'success');
                    
                    if (data.inventory && data.inventory.length > 0) {
                        addLog('–ü–µ—Ä—à—ñ 10 —Ç–æ–≤–∞—Ä—ñ–≤:', 'info');
                        data.inventory.slice(0, 10).forEach((item, index) => {
                            addLog(`  ${index + 1}. ${item.name} (${item.sku}): ${item.qty} —à—Ç. [${item.variant}]`, 'info');
                        });
                        
                        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ç–æ–≤–∞—Ä–∏
                        addLog('–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤:', 'info');
                        const notebook = data.inventory.find(item => item.sku === 'notebook');
                        if (notebook) {
                            addLog(`  –ë–ª–æ–∫–Ω–æ—Ç: ${notebook.qty} —à—Ç.`, 'success');
                        } else {
                            addLog('  –ë–ª–æ–∫–Ω–æ—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!', 'error');
                        }
                        
                        const pen = data.inventory.find(item => item.sku === 'pen');
                        if (pen) {
                            addLog(`  –†—É—á–∫–∞: ${pen.qty} —à—Ç.`, 'success');
                        } else {
                            addLog('  –†—É—á–∫–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞!', 'error');
                        }
                    }
                } else {
                    const errorText = await response.text();
                    addLog(`–ü–æ–º–∏–ª–∫–∞: ${errorText}`, 'error');
                }
            } catch (error) {
                addLog(`–ü–æ–º–∏–ª–∫–∞: ${error.message}`, 'error');
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ç–µ—Å—Ç—É—î–º–æ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.addEventListener('load', () => {
            addLog('–°—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.');
        });
    </script>
</body>
</html>
